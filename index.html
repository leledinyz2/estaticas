<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ðŸŽµ Placar Just Dance do Lele ðŸŽµ</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --roxo: #6d2cff;
    --roxo-translucido: rgba(109, 44, 255, 0.25);
    --verde-lima: #b6ff3b;
    --texto: #f4f4f4;
    --texto-sec: #b8b8b8;
    --borda: rgba(255,255,255,0.08);
    --blur: blur(12px);
  }

  * { box-sizing: border-box; }
  body {
    font-family: "Nunito", sans-serif;
    background: radial-gradient(circle at top left, #0a0613, #100820 60%, #0c0615 100%);
    color: var(--texto);
    margin: 0;
    padding: 0;
    min-height: 100vh;
  }

  header {
    position: sticky;
    top: 0;
    backdrop-filter: var(--blur);
    background: var(--roxo-translucido);
    border-bottom: 1px solid rgba(255,255,255,0.08);
    text-align: center;
    padding: 24px 12px;
    font-size: 1.8rem;
    font-weight: 700;
    color: #fff;
    border-radius: 0 0 20px 20px;
    box-shadow: 0 4px 30px rgba(0,0,0,0.4);
  }

  .container {
    max-width: 1000px;
    margin: 50px auto;
    background: rgba(25, 17, 50, 0.4);
    border: 1px solid var(--borda);
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 4px 40px rgba(0,0,0,0.4);
    backdrop-filter: blur(20px) saturate(160%);
  }

  .controls {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
    margin-bottom: 20px;
    align-items: flex-end;
  }

  label {
    font-size: 0.9rem;
    color: var(--texto-sec);
    display: block;
    margin-bottom: 6px;
  }

  select, input {
    padding: 10px 14px;
    border-radius: 10px;
    border: 1px solid var(--borda);
    background: rgba(255,255,255,0.08);
    color: var(--texto);
    outline: none;
    transition: 0.2s;
    font-size: 0.95rem;
    backdrop-filter: blur(8px);
  }

  select:focus, input:focus {
    border-color: var(--verde-lima);
    box-shadow: 0 0 8px var(--verde-lima);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
    border-radius: 10px;
    overflow: hidden;
  }

  th, td {
    padding: 14px 10px;
    text-align: left;
    border-bottom: 1px solid rgba(255,255,255,0.07);
  }

  th {
    color: var(--verde-lima);
    font-weight: 700;
    font-size: 1rem;
    background: rgba(109,44,255,0.12);
    backdrop-filter: blur(8px);
  }

  tr:hover {
    background: rgba(182,255,59,0.08);
    transition: 0.25s;
  }

  footer {
    text-align: center;
    color: var(--texto-sec);
    margin-top: 24px;
    font-size: 0.9rem;
  }

  ::placeholder {
    color: #999;
  }
</style>
</head>
<body>
<header>ðŸŽµ Placar Just Dance do Lele ðŸŽµ</header>

<div class="container">
  <div class="controls">
    <div>
      <label>Filtro por estrelas mÃ­nimas:</label>
      <select id="filtroEstrelas">
        <option value="0">Todas</option>
        <option value="1">1+</option>
        <option value="2">2+</option>
        <option value="3">3+</option>
        <option value="4">4+</option>
        <option value="5">5</option>
      </select>
    </div>
    <div style="flex:1">
      <label>Buscar mÃºsica:</label>
      <input id="buscaMusica" type="text" placeholder="Digite o nome..." style="width:100%"/>
    </div>
  </div>

  <table id="tabela" aria-live="polite">
    <thead>
      <tr>
        <th>MÃºsica</th>
        <th>VersÃ£o</th>
        <th>PontuaÃ§Ã£o</th>
        <th>Estrelas</th>
        <th>Jogo</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <footer>Atualiza automaticamente com base na planilha do Lele ðŸ’ƒ</footer>
</div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTas34kcpM1cQdW2oR_XjNlINTVShbwfTyVdYnBe2glvdvlJbcDlbQ0npgTdJZ_6p-tQgozmHmnsCQy/pub?gid=0&single=true&output=csv";

function parseCSV(text) {
  const rows = [];
  let i = 0, cur = '', row = [], inQuotes = false;
  while (i < text.length) {
    const ch = text[i];
    if (inQuotes) {
      if (ch === '"') {
        if (text[i+1] === '"') { cur += '"'; i += 2; continue; }
        inQuotes = false; i++; continue;
      } else { cur += ch; i++; continue; }
    } else {
      if (ch === '"') { inQuotes = true; i++; continue; }
      if (ch === ',') { row.push(cur); cur = ''; i++; continue; }
      if (ch === '\r') { i++; continue; }
      if (ch === '\n') { row.push(cur); rows.push(row); row = []; cur = ''; i++; continue; }
      cur += ch; i++;
    }
  }
  if (cur !== '' || row.length) row.push(cur);
  if (row.length) rows.push(row);
  return rows;
}

async function carregarDados() {
  const res = await fetch(CSV_URL);
  const text = await res.text();
  const parsed = parseCSV(text);
  const headers = parsed[0].map(h => h.trim());
  const dados = parsed.slice(1).map(r => {
    const obj = {};
    headers.forEach((h, i) => {
      obj[h] = (r[i] || "")
        .replace(/['"]+/g, "")
        .replace(/\r?\n/g, " ")
        .trim();
    });
    return obj;
  });
  return { headers, dados };
}

function detectColumns(headers) {
  const find = (names) => headers.find(h => names.some(n => h.toLowerCase().includes(n))) || null;
  return {
    musica: find(["mÃºsica", "musica", "song"]) || headers[0],
    versao: find(["versÃ£o", "versao", "version"]) || headers[1],
    pontuacao: find(["pontuaÃ§Ã£o", "pontuacao", "score"]) || headers[2],
    estrelas: find(["estrela", "estrelas", "stars"]) || null,
    jogo: find(["jogo", "game"]) || headers[headers.length - 1],
  };
}

function exibirTabela(dados, cols) {
  const tbody = document.querySelector("#tabela tbody");
  tbody.innerHTML = "";
  dados.forEach(d => {
    const estrelasRaw = (d[cols.estrelas] || "").replace(/\s+/g, " ").trim();
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${d[cols.musica] || ""}</td>
      <td>${d[cols.versao] || ""}</td>
      <td>${d[cols.pontuacao] || ""}</td>
      <td>${estrelasRaw}</td>
      <td>${d[cols.jogo] || ""}</td>
    `;
    tbody.appendChild(tr);
  });
}

function aplicarFiltros() {
  const min = parseInt(document.querySelector("#filtroEstrelas").value);
  const busca = document.querySelector("#buscaMusica").value.toLowerCase();
  const filtrado = ALL.filter(d => {
    const estrelasRaw = (d[cols.estrelas] || "");
    const temEstrela = estrelasRaw.match(/[ðŸ’šðŸ©·ðŸ©µðŸ’›]/g);
    const num = temEstrela ? temEstrela.length : 0;
    const nome = (d[cols.musica] || "").toLowerCase();
    return num >= min && nome.includes(busca);
  });
  exibirTabela(filtrado, cols);
}

let ALL = [];
let cols = null;

(async function init(){
  const { headers, dados } = await carregarDados();
  ALL = dados;
  cols = detectColumns(headers);
  exibirTabela(ALL, cols);
})();

document.querySelector("#filtroEstrelas").addEventListener("change", aplicarFiltros);
document.querySelector("#buscaMusica").addEventListener("input", aplicarFiltros);
</script>
</body>
</html>
